# Configuración de Nixpacks para Laravel con límites de subida aumentados
[phases.setup]
nixPkgs = ["...", "php84Extensions.fileinfo"]

[phases.build]
cmds = [
    "composer install --no-dev --optimize-autoloader",
    "npm ci",
    "npm run build",
    "php artisan config:cache",
    "php artisan route:cache",
    "php artisan view:cache"
]

[start]
cmd = "php artisan migrate --force && php-fpm"

# Variables de entorno para PHP - Esto es lo importante para el upload
[variables]
PHP_UPLOAD_MAX_FILESIZE = "100M"
PHP_POST_MAX_SIZE = "100M"
PHP_MEMORY_LIMIT = "256M"
NIXPACKS_PHP_FALLBACK_PATH = "/app/public"
NGINX_CLIENT_MAX_BODY_SIZE = "100M"
